{% extends "sudoku/base.html" %}
{% load static %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'sudoku/css/board.css' %}">
<link rel="stylesheet" href="{% static 'sudoku/css/rulemanager.css' %}">
<link rel="stylesheet" href="{% static 'sudoku/css/accordion.css' %}">
{% endblock %}

{% block content %}
<div id="layoutWrapper" class="layout-wrapper">
	<div id="leftCol" class="left-col">
		<div class="my_board_box">
			<div class="board-container">
			</div>
		</div>
	</div>
	<div id="rightCol" class="right-col">
		<h2 class="text-center mt-4">Create Your Sudoku</h2>
		
		<div class="position-relative">
			<input type="text" id="ruleSearchInput" class="form-control" placeholder="Start typing..." autocomplete="off">
			<ul id="ruleDropdown" class="list-group position-absolute rounded overflow-auto w-100" style="z-index: 1000;"></ul>
		</div>
		
		<div class="mt-4 my_white_box flex-fill overflow-auto" style="max-height: 600px;">
			<div id="accordionContainer" class="accordion w-100 flex-fill"></div>
		</div>
		<!-- Submit Button -->
		<div class="text-center pt-3">
			<button id="submit-sudoku-btn" class="btn btn-success mb-4">Save Sudoku (Console)</button>
		</div>
	</div>
</div>
{% endblock %}

{% block extra_scripts %}
<script type="module" src="{% static 'sudoku/js/ui/creator/creator_ui.js' %}"></script>
<script>
    /*  IMPORTANT

	YOU NEED  style.css

	Use this Structure:

	<div id="layoutWrapper" class="layout-wrapper">
		<div id="leftCol" class="left-col"></div>
		<div id="rightCol" class="right-col"></div>
	</div>

 */

    function resizeLayout() {
        const wrapper = document.getElementById("layoutWrapper");
        const left = document.getElementById("leftCol");

        const isPortrait = window.innerHeight > window.innerWidth;
        wrapper.classList.toggle("portrait", isPortrait);
        wrapper.classList.toggle("landscape", !isPortrait);

        const right = document.getElementById("rightCol");
        right.classList.toggle("landscape", !isPortrait);
        right.classList.toggle("portrait", isPortrait);
	    
        const rect = wrapper.getBoundingClientRect();
        let size;

        if (isPortrait) {
            // Portrait: Quadratische Breite + Höhe, begrenzt durch Wrapper
            const maxHeight = rect.height * 2 / 3;
            const maxWidth = rect.width;
            size = Math.min(maxHeight, maxWidth);

            left.style.width = size + "px";
            left.style.height = size + "px";

            // Rechte Spalte nimmt restliche Höhe ein
            document.getElementById("rightCol").style.width = size + "px";
            document.getElementById("rightCol").style.height = (rect.height - size) + "px";
        } else {
            const maxHeight = rect.height;
            const maxLeftWidth = rect.width * 2 / 3;
            const leftSize = Math.min(maxHeight, maxLeftWidth);

            const availableRight = rect.width - leftSize - 16; // 16px ≈ 1rem margin

            const rightWidth = Math.min(availableRight, 450);

            left.style.width = leftSize + "px";
            left.style.height = leftSize + "px";

            right.style.height = leftSize + "px";
            right.style.width = rightWidth + "px";

            // Center beide, wenn genug Platz für beide plus Abstand
            if (availableRight > 450) {
                wrapper.classList.add("centered");
            } else {
                wrapper.classList.remove("centered");
            }
        }
    }

    window.addEventListener("resize", resizeLayout);
    window.addEventListener("load", resizeLayout);
	document.addEventListener("DOMContentLoaded", () => setTimeout(resizeLayout, 10));
    document.addEventListener("orientationchange", resizeLayout);
</script>
{% endblock %}
