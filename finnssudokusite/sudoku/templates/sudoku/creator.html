{% extends "sudoku/base.html" %}
{% load static %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'sudoku/css/board.css' %}">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" referrerpolicy="no-referrer">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
{% endblock %}

{% block content %}
<h2 class="text-center mt-4">Create Your Sudoku</h2>

<div class="container-fluid mt-4">
  <div class="row h-100">
    <!-- Sidebar with buttons -->
    <div class="col-3 border-end pt-3">
      <div class="d-grid gap-2 px-2">
        <button class="btn btn-outline-primary" onclick="Board.enableMainGrid()">Enable Grid</button>
        <button class="btn btn-outline-primary" onclick="Board.disableMainGrid()">Disable Grid</button>
        <hr>
        <button class="btn btn-outline-success" onclick="showEdgeHints()">Show Edge Hints</button>
        <button class="btn btn-outline-secondary" onclick="Board.hideEdgeHints()">Hide Edge Hints</button>
        <hr>
        <button class="btn btn-outline-success" onclick="showCornerHints()">Show Corner Hints</button>
        <button class="btn btn-outline-secondary" onclick="Board.hideCornerHints()">Hide Corner Hints</button>
      </div>
    </div>

    <!-- Centered board -->
    <div class="col-9 d-flex align-items-center justify-content-center">
      <div style="aspect-ratio: 1; width: 90vmin;">
        {% include "sudoku/components/board.html" %}
      </div>
    </div>
  </div>
</div>
{% endblock %}

{% block extra_scripts %}
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
<script>
  window.IS_CREATOR_MODE = true;
</script>
<script type="module">
  import { Board } from "{% static 'sudoku/js/board.js' %}";

  import { setupStandardRule } from "{% static 'sudoku/js/rules/rule_standard.js' %}";
  import { setupWhiteKropkiRule } from "{% static 'sudoku/js/rules/rule_kropki_white.js' %}";

  // Make Board globally accessible
  window.Board = Board;

  Board.initBoard();

  const standard = setupStandardRule();
  standard.label = "Standard";
  standard.showInCreatorUI = false;
  Board.registerHandler(standard);

  Board.render();

  // Demo edge hint function
  window.showEdgeHints = () => {
    const hints = [];
    for (let r = 0; r < 9; r++) {
      for (let c = 0; c < 9; c++) {
        if (c < 8) hints.push([{ r, c }, { r, c: c + 1 }]);
        if (r < 8) hints.push([{ r, c }, { r: r + 1, c }]);
      }
    }
    console.log(hints)
    Board.showEdgeHints(hints, (r1, c1, r2, c2) => {
      alert(`Clicked edge: (${r1},${c1}) <-> (${r2},${c2})`);
    });
  };

  // Demo corner hint function
  window.showCornerHints = () => {
    const hints = [];
    for (let r = 0; r <= 9; r++) {
      for (let c = 0; c <= 9; c++) {
        if ((r + c) % 2 === 0) {
          hints.push({ r, c });
        }
      }
    }
    Board.showCornerHints(hints, (r, c) => {
      alert(`Clicked corner: (${r},${c})`);
    });
  };
</script>

{% endblock %}
