{% extends "sudoku/base.html" %}
{% load form_filters %}
{% load i18n %}
{% load static %}

{% block title %}Login{% endblock %}

{% block extra_css %}
<style>
	@import url('https://fonts.googleapis.com/css2?family=Londrina+Sketch&display=swap');
	
	.londrina-sketch-regular {
		font-family: "Londrina Sketch", sans-serif;
		font-weight: 400;
		font-style: normal;
	}
	
	html, body {
		height: 100%;
		margin: 0;
		padding: 0;
		background: linear-gradient(180deg, #00395f 0%, #0075c5 100%) !important;
		color: #fff;
	}
	
	.full-height {
		height: calc(100vh - 100px);
	}
	.socialbtn {display: block;}

</style>
{% endblock %}


{% block container %}
<div class="container-fluid full-height d-flex flex-column justify-content-center align-items-center">
	
	<!-- Social Buttons -->
	<div class="row justify-content-center">
		<div class="d-grid gap-3 px-3 mt-4">
			<h3 class="londrina-sketch-regular display-4 fw-bold text-center">{% trans "LOGIN" %}</h3>
			
			<button type="button" class="socialbtn btn btn-light w-100 d-flex align-items-center border shadow-sm">
				<img src="{% static 'sudoku/img/login/loginSign-google.svg' %}" alt="Google" width="24" class="me-3">
				<span class="text-nowrap">Sign in with Google</span>
			</button>
			
			<button type="button" class="socialbtn btn btn-light w-100 d-flex align-items-center border shadow-sm">
				<img src="{% static 'sudoku/img/login/loginSign-Apple.svg' %}" alt="Apple" width="24" class="me-3">
				<span class="text-nowrap">Sign in with Apple</span>
			</button>
			
			<button type="button" class="socialbtn btn btn-light w-100 d-flex align-items-center border shadow-sm">
				<img src="{% static 'sudoku/img/login/loginSign-facebook.svg' %}" alt="Facebook" width="24" class="me-3">
				<span class="text-nowrap">Sign in with Facebook</span>
			</button>
			
			<button type="button" class="btn btn-light w-100 d-flex align-items-center border shadow-sm"
					data-bs-toggle="collapse" data-bs-target="#myCollapse" aria-expanded="false" aria-controls="myCollapse">
				<img src="{% static 'sudoku/img/login/loginSign-mail.svg' %}" alt="Email" width="24" class="me-3">
				<span class="text-nowrap">Sign in with Email</span>
			</button>
			
			<hr>
			<p class="mt-3 text-center">{% trans "NO ACCOUNT?" %}</p>
			<a type="button" href="{% url 'register' %}" class="btn btn-light w-100 text-center border shadow-sm">
				{% trans "CREATE ONE" %}
			</a>
		</div>
	
	</div>
	
	<div class="collapse " id="myCollapse">
		<div class="card shadow-sm border-0">
			<div class="card-body p-4">
				<h3 class="card-title text-center mb-4">Login</h3>
				<form method="post" novalidate>
					{% csrf_token %}
					{% if form.non_field_errors %}
					<div class="alert alert-danger">
						{{ form.non_field_errors }}
					</div>
					{% endif %}
					
					{% for field in form %}
					<div class="mb-3">
						{% if field.name == "username" %}
						<label for="{{ field.id_for_label }}" class="form-label">Username or Email</label>
						{% else %}
						<label for="{{ field.id_for_label }}" class="form-label">{{ field.label }}</label>
						{% endif %}
						{{ field|add_class:"form-control" }}
						{% if field.help_text %}
						<div class="form-text">{{ field.help_text }}</div>
						{% endif %}
						{% for error in field.errors %}
						<div class="invalid-feedback d-block">{{ error }}</div>
						{% endfor %}
					</div>
					{% endfor %}
					
					<button type="submit" class="btn btn-primary w-100">Log In</button>
				</form>
				
				<div class="text-center mt-3">
					<a href="{% url 'password_reset' %}" class="text-decoration-none">Forgot your password?</a>
				</div>
			</div>
		</div>
	</div>


</div>

{% endblock %}

{% block extra_script %}
<script>
	document.addEventListener("DOMContentLoaded", function() {
		var collapse = document.getElementById('collapseExample');
		var socialBtns = document.querySelectorAll('.socialbtn');
		
		// Collapse Events
		collapse.addEventListener('show.bs.collapse', function () {
			socialBtns.forEach(function(btn) {
				btn.style.display = 'none';
			});
		});
		collapse.addEventListener('hide.bs.collapse', function () {
			socialBtns.forEach(function(btn) {
				btn.style.display = '';
			});
		});
		
		// Falls Collapse schon offen ist (z.B. durch "show" Klasse im HTML)
		if (collapse.classList.contains('show')) {
			socialBtns.forEach(function(btn) {
				btn.style.display = 'none';
			});
		}
		
		// Optional: Collapse beim Klick auf einen Socialbtn mit data-bs-target Ã¶ffnen
		socialBtns.forEach(function(btn) {
			btn.addEventListener('click', function(e) {
				var target = btn.getAttribute('data-bs-target');
				if (target === '#collapseExample') {
					var collapseInstance = bootstrap.Collapse.getOrCreateInstance(collapse);
					collapseInstance.show();
				}
			});
		});
	});
</script>

{% endblock %}
